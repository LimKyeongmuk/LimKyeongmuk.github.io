---
title: "Pytorch"
excerpt: ""

categories:
  - 머신러닝
tags:
  - 머신러닝
  - Pytorch
---
# Pytorch
- Pytorch
  - 페이스북에서 개발한 오픈소스 딥러닝 라이브러리로 파이썬을 통해 사용 가능
  - 구현이 직관적이고 간결하여 처음 딥러닝을 시작하는 사용자들에게 좋음
  - 딥러닝의 경우 큰 행렬 연산을 수행하는 경우가 많아서 GPU를 통해 연산하는 경우 속도가 빠른데 Pytorch에서 지원

- Pytorch의 설치
  - https://pytorch.org/
  - 본인의 환경에 맞게 선택하면 pytorch 설치를 위한 명령어 확인 가능

- 실습
  - 목표: Pytorch를 이용해 간단한 네트워크 연산 수행
  - 네트워크 구조
    - 입력층: 3개(입력)
    - 은닉층: 2층(4개의 Processing unit)
    - 출력층: 2개
  
# MNIST_ANN
- MNIST Database
  - 0~9로 이루어진 손글씨 숫자 데이터
  - 28x28 크기의 흑백 이미지
  - 60,000개의 학습데이터, 10,000개의 테스트 데이터로 구성
  
- MNIST 코드 개요
  - 목표: Pytorch를 이용해 MNIST 데이터를 분류하는 ANN 네트워크 구현
  - 개요
    - MNIST 데이터의 숫자를 분류하는 분류기
    - MNIST 데이터는 28x28x1로 구성된 흑백 데이터
    - 선형 연산을 위해선 데이터가 2차원이 되어야 하기 때문에 batch x 28x28x1의 데이터를 batch x 784의 데이터로 변환해서 입력층으로 사용
    - 인공신경망 연산을 3층의 은닉층에서 선형 연산을 수행
    - 10개의 값을 도출해서 출력(0~9까지의 결과 확률)
  
- MNIST 코드

### MNIST_CNN
- MNIST 코드 개요
  - 목표: Pytorch를 이용해 MNIST 데이터를 분류하는 CNN 네트워크 구현
  - 개요
    - MNIST 데이터의 숫자를 분류하는 분류기
    - MNIST 데이터는 28x28x1로 구성된 흑백 데이터
    - 3개의 Convolution과 3개의 Linear layer
    - 10개의 값을 도출해서 출력(0~9까지의 결과 확률)
  
### MNIST_RNN
- MNIST 코드 개요
  - 목표: Pytorch를 이용해 MNIST 데이터를 분류하는 RNN 네트워크 구현
  - 개요
    - MNIST의 이미지 데이터를 순차적 데이터로 변환한 후 이를 LSTM의 입력으로 하여 숫자 분류
    - 어떻게 이미지 데이터를 순차적 데이터로 바꿀 수 있을까?
    - MNIST는 28x28 이미지인데 이를 1x28개의 길이 28을 가진 28개의 데이터로 나뉨  
  - 구조
    - 2층의 LSTM(processing unit = 256, dropout = 0.2)
    - 마지막 step의 LSTM 출력만 이용
    - 1층의 선형 연산을 통한 출력 도출
    - ANN, CNN과 다른 부분 위주로 설명 예정
  
### Q Learning
- GYM
  - OpenAI에서 제공하는 라이브러리
  - 다양한 강화학습 환경을 포함
  - https://gym.openai.com/
  
- Taxi-v2
  - gym에서 제공하는 환경 중 하나
  - 노란색 박스: 빈 택시
  - 초록색 박스: 승객이 탑승한 택시
  - RGYB: 승객의 위치, 목적지
  - 상태
    - 택시의 위치(25)
    - 승객의 위치(5)
    - 목적지(4)
    - 0~500의 scalar 값으로 변경  
  - 행동
    - 0: 아래
    - 1: 위
    - 2: 오른쪽
    - 3: 왼쪽
    - 4: 승객 태우기
    - 5: 승객 내리기  
  - 보상
    - 매 이동시 -1
    - 승객을 잘못 태우거나 내리면 -10
    - 승객을 목적지에 내려주면 +20
  
- CartPole
  - gym에서 제공하는 환경 중 하나
  - 카트를 좌우로 이동하여 막대가 쓰러지지 않도록 제어
  - 상태
    - 카트의 위치
    - 카트의 속력
    - 막대기의 각도
    - 막대기의 끝부분(상단) 속도  
  - 행동
    - 카트를 좌우로 이동  
  - 보상
    - 막대가 넘어지지 않으면 +1점을 받음  
  - 게임 종료
    - 막대기가 수직으로부터 12도 이상 기울어짐(-12도~12도)
    - 카트가 중심으로부터 2.4 이상 벗어남(-2.4~2.4)
    - 시간 스텝이 200보다 커짐  
  - DQN 개요
    - Q-learning과 인공신경망을 결합
    - 이미지 정보를 입력으로 하는 경우 CNN 사용
    - CartPole은 벡터 정보를 입력으로 하기 때문에 ANN 사용 예정
  
- CartPole
  - gym에서 제공하는 환경 중 하나
  - 카트를 좌우로 이동하여 막대가 쓰러지지 않도록 제어
  - 상태
    - 카트의 위치
    - 카트의 속력
    - 막대기의 각도
    - 막대기의 끝부분(상단) 속도  
  - 행동
    - 카트를 좌우로 이동  
  - 보상
    - 막대가 넘어지지 않으면 +1점을 받음  
  - 게임 종료
    - 막대기가 수직으로부터 12도 이상 기울어짐(-12도~12도)
    - 카트가 중심으로부터 2.4 이상 벗어남(-2.4~2.4)
    - 시간 스텝이 200보다 커짐  
  - 최종 목표
    - CartPole 학습 -> 만점 200점 받기
    - DQN의 추가 기법 적용
      - Frame Skipping & Stacking
      - Experience Replay
      - Target Network  
    - 기존 DQN 코드에서 추가된 내용들만 설명할 예정