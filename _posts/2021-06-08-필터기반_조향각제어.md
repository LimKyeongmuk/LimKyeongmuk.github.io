---
title: "필터 기반 조향각 제어"
excerpt: ""

categories:
  - OpenCV
tags:
  - OpenCV
  - Python
---
### 차선 위치 정보를 이용한 조향각 제어 방법
- 자동차 운전 = 조향 및 속도 제어
  - 조향각 제어  
    - 직선 차로: 정면으로 직진
    - 곡선 차로: 차로가 휘어진 방향으로 조향(적절한 조향각 설정 필요)
  
  - 속도 제어
    - 직선 주로에서는 빠르게(보다 좋은 랩 타임을 기록 가능)
    - 곡선 주로에서는 적절히 느리게(차선 이탈 방지)
  
- 차선의 위치 정보를 이용한 조향각 제어
  - 양쪽 차선의 위치를 찾아서 양쪽 차선의 중간값을 구하고 화면의 중앙과 비교해서 차이만큼 핸들 꺾기(조향각 제어)
  
- 조향 제어 기법
  - 직진의 경우 중앙선과 일치하게
  - 회전의 경우: 중앙선과 차이 발생(한쪽으로 꺾어야 함)

- 조향각의 설정
  - 인식된 양쪽 차선의 중점
    - 카메라가 차량의 중앙에 위치하고 있다면 화면 중앙 지점과 거리차이에 따라 조향 정도를 설정
    - 몇 픽셀에 1도씩 꺾어야 하는지 고민해보기
  
- 조향각 제어의 문제점
  - 카메라를 통한 차선 인식의 한계점들
    - 빛, 그늘, 반사광, 장애물 때문에 차선이 가리는 경우
    - 급커브 등 차선이 시야에서 벗어나 안보이는 경우
  
  - 차선 인식에 오류가 생기면
    - 조향각 변동이 심해져서 핸들을 확확 꺾는 것과 동일함
    - 조향각이 자꾸 변하면 핸들이 자꾸 움직이고 차량이 좌우로 심하게 흔들리거나 차선이탈의 위험이 있음
  
- 안정적인 주행
  - 부드러운 핸들링이 필요
  - 조향각 값에 대한 필터링
  
- 조향각에 대한 필터링
  - 카메라에서 차선 찾은 후
  - 조향 각 계산한 것을 필터링을 통해서 모터 제어
  
### 필터를 이용한 부드러운 핸들링 방법
- 간단한 필터들
  - 평균 필터(Average filter)
  - 이동평균 필터(Moving average filter)
  - 가중 이동평균 필터
  - 저주파 통과 필터(Low-pass filter)
  
- 필터 기반 조향각 제어
  - 핸들링에는 어떤 필터가 적당할까?
    - 이동평균 필터(과거 값은 버리는 것이 좋음)
    - 가중 이동평균 필터(최신 값이 더 중요하기 때문에)
  
  - 어떤 데이터에 필터를 적용해야 할까?
    - 차선위치 데이터?
    - 조향각 데이터?
  
- 필터 코드 적용
  - 차선의 위치값에 오류(노이즈)가 섞여 있으므로 필터를 적용해보기(Day2 동영상1 24:30)
  
- 과제
  - 1) 조향각 데이터가 아닌 차선위치 데이터에 적용해보기(angle, lpos/rpos)
  - 2) 차량의 속도가 느릴 때와 빠를 때, 어떤 필터가 효과적인지 알아보기(저속 주행, 고속 주행, 이동평균 필터, 가중 이동평균 필터)